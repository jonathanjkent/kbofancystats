title <- paste0(list$Name[i], " | ", list$KName[i])
subtitle <- paste0(list$Team[i], " | ", list$Position[i])
id <- list$Code[i]
a <- "---"
b <- paste0('title: ', title)
bb <- paste0('subtitle: ', subtitle)
bc <- 'summary: "Career Stats"'
c <- "```{r , echo=F,warning=FALSE,message=FALSE}"
f <- "library(kableExtra)"
g <- 'd <- read.csv("~/Google Drive/KBO/batters_simple.csv")'
j <- paste0('d <- subset(d, Code == "', id, '", select = c(-Name, -KName, -Position, -Code, -Url))')
k <- 'd <- d[order(-d$Year),]'
k2 <- 'd$Team <- paste0("[", d$Team, "](/teams/", gsub("[[:space:]]", "", d$Team), ")")'
l <- 'kable(d, digits = c(0,0,0,0,0,0,3,1,1,3,3,1,2), row.names = FALSE, col.names = c("Season","Age","Team","G","PA","HR","OPS","BB%","SO%","ISO","BABIP","wRC+","WAR")) %>% kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T)'
m <- "```"
n1 <- "<br>"
n2 <- paste0("**More** | [myKBO Page](",list$Url[i],")")
file <- paste0(gsub("[[:space:]]", "", id), ".rmd")
writeLines(c(a,b,bb,bc,a,c,f,g,j,k2,l,m,n1,n2), file)
}
setwd("~/Google Drive/KBO/kbofancystats/content/players")
list <- pitchers %>% select(Name, Code, KName, Team, Position, Url)
list <- unique(list)
list <- list %>% map_df(rev)
#list <- listpit
for (i in 1:nrow(list)){
title <- paste0(list$Name[i], " | ", list$KName[i])
subtitle <- paste0(list$Team[i], " | ", list$Position[i])
id <- list$Code[i]
a <- "---"
b <- paste0('title: ', title)
bb <- paste0('subtitle: ', subtitle)
bc <- 'summary: "Career Stats"'
c <- "```{r , echo=F,warning=FALSE,message=FALSE}"
f <- "library(kableExtra)"
g <- 'd <- read.csv("~/Google Drive/KBO/pitchers_simple.csv")'
j <- paste0('d <- subset(d, Code == "', id, '", select = c(-Name, -KName, -Position, -Code, -Url))')
jj <- 'd <- subset(d, Year > 2013)'
k <- 'd <- d[order(-d$Year),]'
k2 <- 'd$Team <- paste0("[", d$Team, "](/teams/", gsub("[[:space:]]", "", d$Team), ")")'
l <- 'kable(d, digits = c(0,0,0,0,0,1,1,1,1,3,2,2,2), row.names = FALSE, col.names = c("Season","Age","Team","G","GS","IP","K/9","BB/9","HR/9","BABIP","ERA","FIP","WAR")) %>% kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T)'
m <- "```"
n1 <- "<br>"
n2 <- paste0("**More** | [myKBO Page](",list$Url[i],")")
file <- paste0(gsub("[[:space:]]", "", id), ".rmd")
writeLines(c(a,b,bb,bc,a,c,f,g,j,jj,k2,l,m,n1,n2), file)
}
# Leaders Homepage Widget
batters <- read_csv("~/Google Drive/KBO/batters_simple.csv")
pitchers <- read_csv("~/Google Drive/KBO/pitchers_simple.csv")
batters <- unique(batters)
pitchers <- unique(pitchers)
batters <- batters %>% filter(Year == 2020)
pitchers <- pitchers %>% filter(Year == 2020)
batwar <- batters %>% select(Code,Name,Team,Position,WAR)
pitwar <- pitchers %>% select(Code,Name,Team,Position,WAR)
d <- rbind(batwar,pitwar)
d <- d %>% arrange(desc(WAR))
d <- d[1:10,]
a <- '+++'
b <- 'widget = "blank"'
c <- 'headless = true'
dd <- 'active = true'
e <- 'weight = 2'
f <- 'title = "WAR Leaders"'
g <- '[design.spacing]'
h <- 'padding = ["50px", "25%", "0px", "25%"]'
ii <- '[design.background]'
j <- 'color = "white"'
k <- '+++'
l <- '| Rank | Name | Team | Position | WAR |'
m <- '| :---: | --- | --- | ------- | -- |'
war1 <- paste0('| 1 | [**',as.character(d[1,2]),'**](/players/',as.character(d[1,1]),') | [',as.character(d[1,3]),'](/teams/',gsub("[[:space:]]", "", as.character(d[1,3])), ') | ', as.character(d[1,4]),' | ',sprintf('%.2f',d[1,5]),' |')
war2 <- paste0('| 2 | [**',as.character(d[2,2]),'**](/players/',as.character(d[2,1]),') | [',as.character(d[2,3]),'](/teams/',gsub("[[:space:]]", "", as.character(d[2,3])), ') | ', as.character(d[2,4]),' | ',sprintf('%.2f',d[2,5]),' |')
war3 <- paste0('| 3 | [**',as.character(d[3,2]),'**](/players/',as.character(d[3,1]),') | [',as.character(d[3,3]),'](/teams/',gsub("[[:space:]]", "", as.character(d[3,3])), ') | ', as.character(d[3,4]),' | ',sprintf('%.2f',d[3,5]),' |')
war4 <- paste0('| 4 | [**',as.character(d[4,2]),'**](/players/',as.character(d[4,1]),') | [',as.character(d[4,3]),'](/teams/',gsub("[[:space:]]", "", as.character(d[4,3])), ') | ', as.character(d[4,4]),' | ',sprintf('%.2f',d[4,5]),' |')
war5 <- paste0('| 5 | [**',as.character(d[5,2]),'**](/players/',as.character(d[5,1]),') | [',as.character(d[5,3]),'](/teams/',gsub("[[:space:]]", "", as.character(d[5,3])), ') | ', as.character(d[5,4]),' | ',sprintf('%.2f',d[5,5]),' |')
setwd("~/Google Drive/KBO/kbofancystats/content/home")
writeLines(c(a,b,c,dd,e,f,g,h,ii,j,k,l,m,war1,war2,war3,war4,war5), "blank.md")
# Refresh Pages
render("~/Google Drive/KBO/kbofancystats/content/leaders.Rmd")
render("~/Google Drive/KBO/kbofancystats/content/elo.Rmd")
batters19 <- read_csv("batrawstat.csv")
batters19$Url <- "-"
batters19$Born <- "-"
batters19$Age <- "_"
batters19 <- batters19 %>% select(names(batters)) %>% filter(Year == 2019)
pitchers19 <- read_csv("pitrawstat.csv")
pitchers19$Url <- "-"
pitchers19$Born <- "-"
pitchers19$Age <- "_"
pitchers19 <- pitchers19 %>% select(names(pitchers)) %>% filter(Year == 2019)
batters19since <- rbind(batters,batters19)
pitchers19since <- rbind(pitchers,pitchers19)
# Summarize and fix batters
batters19since <-  batters19since %>% select(-Url, -Name, -Position, -Number, -KName, -Born, -Age, -PF)
batters19since <- batters19since %>% group_by(Code) %>%
summarise_at(vars(G:WAR), sum, na.rm = TRUE)
basics <- batters19 %>% select(Code, Name, KName, Position, Team, Url)
batters19since <- batters19since %>% left_join(basics, by = "Code")
batters19since <- batters19since[!is.na(batters19since$Name),]
batters19since$Year <- "Since 2019"
batters19since$Age <- "_"
batters19since <- batters19since %>% left_join(pf, by = "Team")
# Summarize and fix pitchers
pitchers19since <-  pitchers19since %>% select(-CG.SHO., -Url, -Name, -Position, -Number, -KName, -Born, -Age, -PF)
pitchers19since <- unique(pitchers19since)
pitchers19since$IP2 <- as.numeric(pitchers19since$IP2)
pitchers19since <- pitchers19since %>% group_by(Code) %>%
summarise_at(vars(G:WAR), sum, na.rm = TRUE)
basics <- pitchers19 %>% select(Code, Name, KName, Position, Team, Url)
pitchers19since <- pitchers19since %>% left_join(basics, by = "Code")
pitchers19since <- pitchers19since[!is.na(pitchers19since$Name),]
pitchers19since$Year <- "Since 2019"
pitchers19since$Age <- "_"
pitchers19since <- pitchers19since %>% left_join(pf, by = "Team")
pitchers19since$IP <- as.character(pitchers19since$IP2)
pitchers19since <- pitchers19since %>% separate(IP, c("a", "b"))
pitchers19since$b[is.na(pitchers19since$b)] <- 0
pitchers19since$IP <- as.numeric(pitchers19since$a) + as.numeric(pitchers19since$b)*(1/3)
pitchers19since$IP2 <- as.character(pitchers19since$IP)
pitchers19since <- pitchers19since %>% select(-a, -b)
pitchers19since <- pitchers19since %>% separate(IP2, c("a", "b"))
pitchers19since$b[is.na(pitchers19since$b)] <- 0
pitchers19since$b <-paste0("0.",pitchers19since$b)
pitchers19since$b <- as.numeric(pitchers19since$b)
pitchers19since$b <- pitchers19since$b * 3
pitchers19since$b <- as.character(round(pitchers19since$b))
pitchers19since$IP2 <- paste0(pitchers19since$a,".",pitchers19since$b)
pitchers19since <- pitchers19since %>% select(-a, -b)
# Batter stats (since 2019)
batters19since$wOBA <- (wBB*(batters19since$BB-batters19since$IBB) + wHBP*batters19since$HBP + w1B*batters19since$X1B + w2B*batters19since$X2B + w3B*batters19since$X3B + wHR*batters19since$HR)/(batters19since$PA)
batters19since$wRAA <- ((batters19since$wOBA-lgwOBA)/wOBAscale)*batters19since$PA
batters19since$wRCplus <- (((batters19since$wRAA/batters19since$PA + lgRPA19) + (lgRPA19 - batters19since$PF*lgRPA19))/(lgRPA19))*100
batters19since$BBpct <- (batters19since$BB/batters19since$PA)*100
batters19since$SOpct <- (batters19since$SO/batters19since$PA)*100
batters19since$OBP <- (batters19since$H + batters19since$BB + batters19since$HBP)/(batters19since$PA)
batters19since$SLG <- (batters19since$X1B + (2*batters19since$X2B) + (3*batters19since$X3B) + (4*batters19since$HR))/batters19since$AB
batters19since$OPS <- batters19since$OBP + batters19since$SLG
batters19since$BA <- batters19since$H/batters19since$AB
batters19since$ISO <- batters19since$SLG-batters19since$BA
batters19since$BABIP <- (batters19since$H - batters19since$HR)/(batters19since$AB - batters19since$SO - batters19since$HR + batters19since$SF)
## Pitcher Stats
pitchers19since$FIP <- ((13*pitchers19since$HR)+(3*(pitchers19since$BB+pitchers19since$HB))-(2*pitchers19since$SO))/pitchers19since$IP + FIPcon
pitchers19since$BABIP <- (pitchers19since$H - pitchers19since$HR)/(pitchers19since$TBF - pitchers19since$BB - pitchers19since$IBB - pitchers19since$HB - pitchers19since$SO - pitchers19since$HR)
pitchers19since$SO9 <- pitchers19since$SO/pitchers19since$IP*9
pitchers19since$BB9 <- pitchers19since$BB/pitchers19since$IP*9
pitchers19since$HR9 <- pitchers19since$HR/pitchers19since$IP*9
pitchers19since$ERA <- (pitchers19since$ER/pitchers19since$IP)*9
batters.since19 <- batters19since %>% select(Year, Name, KName, Age, Position, Team, G, PA, HR, OPS, BBpct, SOpct, ISO, BABIP, wRCplus, WAR, Code, Url)
pitchers.since19 <- pitchers19since %>% select(Year, Name, KName, Age, Position, Team, G, GS, IP2, SO9, BB9, HR9, BABIP, ERA, FIP, WAR, Code, Url)
setwd("~/Google Drive/KBO")
batters19 <- read_csv("batrawstat.csv")
batters19$Url <- "-"
batters19$Born <- "-"
batters19$Age <- "_"
batters19 <- batters19 %>% select(names(batters)) %>% filter(Year == 2019)
pitchers19 <- read_csv("pitrawstat.csv")
pitchers19$Url <- "-"
pitchers19$Born <- "-"
pitchers19$Age <- "_"
pitchers19 <- pitchers19 %>% select(names(pitchers)) %>% filter(Year == 2019)
batters19since <- rbind(batters,batters19)
pitchers19since <- rbind(pitchers,pitchers19)
batters19since <-  batters19since %>% select(-Url, -Name, -Position, -Number, -KName, -Born, -Age, -PF)
batters19since <- batters19since %>% group_by(Code) %>%
summarise_at(vars(G:WAR), sum, na.rm = TRUE)
basics <- batters19 %>% select(Code, Name, KName, Position, Team, Url)
batters19since <- batters19since %>% left_join(basics, by = "Code")
batters19since <- batters19since[!is.na(batters19since$Name),]
batters19since$Year <- "Since 2019"
batters19since$Age <- "_"
batters19since <- batters19since %>% left_join(pf, by = "Team")
batters19 <- read_csv("batrawstat.csv")
batters19$Url <- "-"
batters19$Born <- "-"
batters19$Age <- "_"
batters19 <- batters19 %>% select(names(batters)) %>% filter(Year == 2019)
pitchers19 <- read_csv("pitrawstat.csv")
pitchers19$Url <- "-"
pitchers19$Born <- "-"
pitchers19$Age <- "_"
pitchers19 <- pitchers19 %>% select(names(pitchers)) %>% filter(Year == 2019)
batters19since <- rbind(batters,batters19)
pitchers19since <- rbind(pitchers,pitchers19)
# Summarize and fix batters
batters19since <-  batters19since %>% select(-Url, -Name, -Position, -KName, -Born, -Age, -PF)
# Summarize and fix batters
batters19since <-  batters19since %>% select(-Url, -Name, -Position, -KName, -Age, -PF)
### Since 2019
batters <- read_csv("batters_full_20.csv")
pitchers <- read_csv("pitchers_full_20.csv")
batters19 <- read_csv("batrawstat.csv")
batters19$Url <- "-"
batters19$Born <- "-"
batters19$Age <- "_"
batters19 <- batters19 %>% select(names(batters)) %>% filter(Year == 2019)
pitchers19 <- read_csv("pitrawstat.csv")
pitchers19$Url <- "-"
pitchers19$Born <- "-"
pitchers19$Age <- "_"
pitchers19 <- pitchers19 %>% select(names(pitchers)) %>% filter(Year == 2019)
batters19since <- rbind(batters,batters19)
pitchers19since <- rbind(pitchers,pitchers19)
# Summarize and fix batters
batters19since <-  batters19since %>% select(-Url, -Name, -Position, -Number, -KName, -Born, -Age, -PF)
batters19since <- batters19since %>% group_by(Code) %>%
summarise_at(vars(G:WAR), sum, na.rm = TRUE)
basics <- batters19 %>% select(Code, Name, KName, Position, Team, Url)
batters19since <- batters19since %>% left_join(basics, by = "Code")
batters19since <- batters19since[!is.na(batters19since$Name),]
batters19since$Year <- "Since 2019"
batters19since$Age <- "_"
batters19since <- batters19since %>% left_join(pf, by = "Team")
# Summarize and fix pitchers
pitchers19since <-  pitchers19since %>% select(-CG.SHO., -Url, -Name, -Position, -Number, -KName, -Born, -Age, -PF)
pitchers19since <- unique(pitchers19since)
pitchers19since$IP2 <- as.numeric(pitchers19since$IP2)
pitchers19since <- pitchers19since %>% group_by(Code) %>%
summarise_at(vars(G:WAR), sum, na.rm = TRUE)
basics <- pitchers19 %>% select(Code, Name, KName, Position, Team, Url)
pitchers19since <- pitchers19since %>% left_join(basics, by = "Code")
pitchers19since <- pitchers19since[!is.na(pitchers19since$Name),]
pitchers19since$Year <- "Since 2019"
pitchers19since$Age <- "_"
pitchers19since <- pitchers19since %>% left_join(pf, by = "Team")
pitchers19since$IP <- as.character(pitchers19since$IP2)
pitchers19since <- pitchers19since %>% separate(IP, c("a", "b"))
pitchers19since$b[is.na(pitchers19since$b)] <- 0
pitchers19since$IP <- as.numeric(pitchers19since$a) + as.numeric(pitchers19since$b)*(1/3)
pitchers19since$IP2 <- as.character(pitchers19since$IP)
pitchers19since <- pitchers19since %>% select(-a, -b)
pitchers19since <- pitchers19since %>% separate(IP2, c("a", "b"))
pitchers19since$b[is.na(pitchers19since$b)] <- 0
pitchers19since$b <-paste0("0.",pitchers19since$b)
pitchers19since$b <- as.numeric(pitchers19since$b)
pitchers19since$b <- pitchers19since$b * 3
pitchers19since$b <- as.character(round(pitchers19since$b))
pitchers19since$IP2 <- paste0(pitchers19since$a,".",pitchers19since$b)
pitchers19since <- pitchers19since %>% select(-a, -b)
# Batter stats (since 2019)
batters19since$wOBA <- (wBB*(batters19since$BB-batters19since$IBB) + wHBP*batters19since$HBP + w1B*batters19since$X1B + w2B*batters19since$X2B + w3B*batters19since$X3B + wHR*batters19since$HR)/(batters19since$PA)
batters19since$wRAA <- ((batters19since$wOBA-lgwOBA)/wOBAscale)*batters19since$PA
batters19since$wRCplus <- (((batters19since$wRAA/batters19since$PA + lgRPA19) + (lgRPA19 - batters19since$PF*lgRPA19))/(lgRPA19))*100
batters19since$BBpct <- (batters19since$BB/batters19since$PA)*100
batters19since$SOpct <- (batters19since$SO/batters19since$PA)*100
batters19since$OBP <- (batters19since$H + batters19since$BB + batters19since$HBP)/(batters19since$PA)
batters19since$SLG <- (batters19since$X1B + (2*batters19since$X2B) + (3*batters19since$X3B) + (4*batters19since$HR))/batters19since$AB
batters19since$OPS <- batters19since$OBP + batters19since$SLG
batters19since$BA <- batters19since$H/batters19since$AB
batters19since$ISO <- batters19since$SLG-batters19since$BA
batters19since$BABIP <- (batters19since$H - batters19since$HR)/(batters19since$AB - batters19since$SO - batters19since$HR + batters19since$SF)
## Pitcher Stats
pitchers19since$FIP <- ((13*pitchers19since$HR)+(3*(pitchers19since$BB+pitchers19since$HB))-(2*pitchers19since$SO))/pitchers19since$IP + FIPcon
pitchers19since$BABIP <- (pitchers19since$H - pitchers19since$HR)/(pitchers19since$TBF - pitchers19since$BB - pitchers19since$IBB - pitchers19since$HB - pitchers19since$SO - pitchers19since$HR)
pitchers19since$SO9 <- pitchers19since$SO/pitchers19since$IP*9
pitchers19since$BB9 <- pitchers19since$BB/pitchers19since$IP*9
pitchers19since$HR9 <- pitchers19since$HR/pitchers19since$IP*9
pitchers19since$ERA <- (pitchers19since$ER/pitchers19since$IP)*9
batters.since19 <- batters19since %>% select(Year, Name, KName, Age, Position, Team, G, PA, HR, OPS, BBpct, SOpct, ISO, BABIP, wRCplus, WAR, Code, Url)
pitchers.since19 <- pitchers19since %>% select(Year, Name, KName, Age, Position, Team, G, GS, IP2, SO9, BB9, HR9, BABIP, ERA, FIP, WAR, Code, Url)
## Reduce
batters.20 <- batters %>% select(Year, Name, KName, Age, Position, Team, G, PA, HR, OPS, BBpct, SOpct, ISO, BABIP, wRCplus, WAR, Code, Url)
pitchers.20 <- pitchers %>% select(Year, Name, KName, Age, Position, Team, G, GS, IP2, SO9, BB9, HR9, BABIP, ERA, FIP, WAR, Code, Url)
## Combine With Pre-2020 Stats
batters.1019 <- read_csv("batters_simple_10to19.csv")
pitchers.1019 <- read_csv("pitchers_simple_10to19.csv")
batters.all <- rbind(batters.20, batters.1019)
pitchers.all <- rbind(pitchers.20, pitchers.1019)
batters.all <- rbind(batters.all,batters.since19)
pitchers.all <- rbind(pitchers.all,pitchers.since19)
batters.all <- unique(batters.all)
pitchers.all <- unique(pitchers.all)
stop_server()
## Save
write_csv(batters.all, "batters_simple.csv")
write_csv(pitchers.all, "pitchers_simple.csv")
## Start Site
setwd("~/Google Drive/KBO/kbofancystats")
serve_site()
## Write and Update Pages
setwd("~/Google Drive/KBO/kbofancystats/content/teams")
batters <- read_csv("~/Google Drive/KBO/batters_simple.csv")
pitchers <- read_csv("~/Google Drive/KBO/pitchers_simple.csv")
list <- batters %>% filter(Year == "2020") %>% select(Team)
list <- unique(list$Team)
batleaders <- batters %>% select(Name, Position, WAR, Year, Team)
pitleaders <- pitchers %>% select(Name, Position, WAR, Year, Team)
leaders <- rbind(batleaders, pitleaders)
tops <- leaders %>% filter(Year == "2020") %>% group_by(Team) %>% top_n(3, WAR)
tops <- tops[order(-tops$WAR),]
tops$WAR <- round(tops$WAR, 2)
current.elos <- read_csv("~/Google Drive/KBO/currentelos.csv")
current.elos$Elo <- round(current.elos$Elo, 0)
cities <- read_csv("~/Google Drive/KBO/teamcities.csv")
tops <- tops %>% left_join(cities, by = "Team")
for (i in list){
top <- tops %>% filter(Team == i)
top3 <- paste0("WAR Leader | ",top[1,1],", ",top[1,2],": ",top[1,3])
elo <- current.elos %>% filter(Team == i)
elo <- paste0(top[1,6]," | Current Elo: ",elo[1,2]," (",elo[1,3],")")
a <- "---"
b <- 'date: "2020-03-31"'
c <- paste0("summary: ","'", top3,"'")
d <- paste0("title: ","'", i,"'")
da <- paste0("subtitle: ","'", elo,"'")
db <- "image:"
dc <- "  preview_only: true"
ea <- "**2020** | [Batting](#batting) | [Pitching](#pitching) | "
eaa <- paste0("**2019** | [Batting](https://www.kbofancystats.com/2019-stats/", gsub("[[:space:]]", "", i),"/#batting) | [Pitching](https://www.kbofancystats.com/2019-stats/",gsub("[[:space:]]", "", i),"/#pitching) | ")
eb <- " "
e <- "### 2020 Batting Stats {#batting}"
f <- "```{r pressure, echo=F,warning=FALSE,message=FALSE}"
g <- "library(tidyverse)"
j <- "library(kableExtra)"
k <- 'batters <- read_csv("~/Google Drive/KBO/batters_simple.csv")'
l <- "batters <- batters[complete.cases(batters),]"
m <- "batters$Age <- as.numeric(batters$Age)"
n <- paste0('d <- batters %>% filter(Team == "', i, '") %>% filter(Year == "2020") %>% select(-Team, -Year, -KName, -Url)')
o <- "d <- d[order(-d$WAR),]"
p <- 'd$Name <- paste0("[", d$Name, "](/players/", d$Code, ")")'
q <- 'kable(d, digits = c(0,0,0,0,0,0,3,1,1,3,3,1,2), col.names = c("Name","Age","Pos","G","PA","HR","OPS","BB%","SO%","ISO","BABIP","wRC+","WAR")) %>% kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>%column_spec(1, bold = T, border_right = F)'
r <- "```"
rr <- "***"
s <- "### 2020 Pitching Stats {#pitching}"
t <- "```{r, echo=F,warning=FALSE,message=FALSE}"
u <- 'pitchers <- read_csv("~/Google Drive/KBO/pitchers_simple.csv")'
v <- 'pitchers <- pitchers[complete.cases(pitchers),]'
w <- paste0('d <- pitchers %>% filter(Team == "', i, '") %>% filter(Year == "2020") %>% select(-Team, -Year, -KName, -Position, -Url)')
x <- 'd <- d[order(-d$WAR),]'
y <- 'd$Name <- paste0("[", d$Name, "](/players/", d$Code, ")")'
ab <- "d <- d %>% select(-Code)"
z <- 'kable(d, digits = c(0,0,0,0,1,1,1,1,3,3,2,2), col.names = c("Name","Age","G","GS","IP","K/9","BB/9","HR/9","BABIP","ERA","FIP","WAR")) %>% kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T) %>% column_spec(1, bold = T, border_right = F)'
teamwd <- paste0("~/Google Drive/KBO/kbofancystats/content/teams/",gsub("[[:space:]]", "", i))
setwd(teamwd)
file <- "index.rmd"
writeLines(c(a,b,c,d,da,db,dc,a,ea,eaa,eb,rr,e,f,g,j,k,l,m,n,o,p,ab,q,r,rr,s,t,u,v,w,x,y,ab,z,r), file)
}
setwd("~/Google Drive/KBO/kbofancystats/content/players")
#list <- batters %>% select(Name, Code, KName, Team, Position, Url)
#list<-unique(list)
#list <- list %>% map_df(rev)
list <- listbat
for (i in 1:nrow(list)){
title <- paste0(list$Name[i], " | ", list$KName[i])
subtitle <- paste0(list$Team[i], " | ", list$Position[i])
id <- list$Code[i]
a <- "---"
b <- paste0('title: ', title)
bb <- paste0('subtitle: ', subtitle)
bc <- 'summary: "Career Stats"'
c <- "```{r , echo=F,warning=FALSE,message=FALSE}"
f <- "library(kableExtra)"
g <- 'd <- read.csv("~/Google Drive/KBO/batters_simple.csv")'
j <- paste0('d <- subset(d, Code == "', id, '", select = c(-Name, -KName, -Position, -Code, -Url))')
k <- 'd <- d[order(-d$Year),]'
k2 <- 'd$Team <- paste0("[", d$Team, "](/teams/", gsub("[[:space:]]", "", d$Team), ")")'
l <- 'kable(d, digits = c(0,0,0,0,0,0,3,1,1,3,3,1,2), row.names = FALSE, col.names = c("Season","Age","Team","G","PA","HR","OPS","BB%","SO%","ISO","BABIP","wRC+","WAR")) %>% kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T)'
m <- "```"
n1 <- "<br>"
n2 <- paste0("**More** | [myKBO Page](",list$Url[i],")")
file <- paste0(gsub("[[:space:]]", "", id), ".rmd")
writeLines(c(a,b,bb,bc,a,c,f,g,j,k2,l,m,n1,n2), file)
}
setwd("~/Google Drive/KBO/kbofancystats/content/players")
list <- pitchers %>% select(Name, Code, KName, Team, Position, Url)
list <- unique(list)
list <- list %>% map_df(rev)
#list <- listpit
for (i in 1:nrow(list)){
title <- paste0(list$Name[i], " | ", list$KName[i])
subtitle <- paste0(list$Team[i], " | ", list$Position[i])
id <- list$Code[i]
a <- "---"
b <- paste0('title: ', title)
bb <- paste0('subtitle: ', subtitle)
bc <- 'summary: "Career Stats"'
c <- "```{r , echo=F,warning=FALSE,message=FALSE}"
f <- "library(kableExtra)"
g <- 'd <- read.csv("~/Google Drive/KBO/pitchers_simple.csv")'
j <- paste0('d <- subset(d, Code == "', id, '", select = c(-Name, -KName, -Position, -Code, -Url))')
jj <- 'd <- subset(d, Year > 2013)'
k <- 'd <- d[order(-d$Year),]'
k2 <- 'd$Team <- paste0("[", d$Team, "](/teams/", gsub("[[:space:]]", "", d$Team), ")")'
l <- 'kable(d, digits = c(0,0,0,0,0,1,1,1,1,3,2,2,2), row.names = FALSE, col.names = c("Season","Age","Team","G","GS","IP","K/9","BB/9","HR/9","BABIP","ERA","FIP","WAR")) %>% kable_styling(bootstrap_options = c("striped", "hover"), fixed_thead = T)'
m <- "```"
n1 <- "<br>"
n2 <- paste0("**More** | [myKBO Page](",list$Url[i],")")
file <- paste0(gsub("[[:space:]]", "", id), ".rmd")
writeLines(c(a,b,bb,bc,a,c,f,g,j,jj,k2,l,m,n1,n2), file)
}
# Leaders Homepage Widget
batters <- read_csv("~/Google Drive/KBO/batters_simple.csv")
pitchers <- read_csv("~/Google Drive/KBO/pitchers_simple.csv")
batters <- unique(batters)
pitchers <- unique(pitchers)
batters <- batters %>% filter(Year == 2020)
pitchers <- pitchers %>% filter(Year == 2020)
batwar <- batters %>% select(Code,Name,Team,Position,WAR)
pitwar <- pitchers %>% select(Code,Name,Team,Position,WAR)
d <- rbind(batwar,pitwar)
d <- d %>% arrange(desc(WAR))
d <- d[1:10,]
a <- '+++'
b <- 'widget = "blank"'
c <- 'headless = true'
dd <- 'active = true'
e <- 'weight = 2'
f <- 'title = "WAR Leaders"'
g <- '[design.spacing]'
h <- 'padding = ["50px", "25%", "0px", "25%"]'
ii <- '[design.background]'
j <- 'color = "white"'
k <- '+++'
l <- '| Rank | Name | Team | Position | WAR |'
m <- '| :---: | --- | --- | ------- | -- |'
war1 <- paste0('| 1 | [**',as.character(d[1,2]),'**](/players/',as.character(d[1,1]),') | [',as.character(d[1,3]),'](/teams/',gsub("[[:space:]]", "", as.character(d[1,3])), ') | ', as.character(d[1,4]),' | ',sprintf('%.2f',d[1,5]),' |')
war2 <- paste0('| 2 | [**',as.character(d[2,2]),'**](/players/',as.character(d[2,1]),') | [',as.character(d[2,3]),'](/teams/',gsub("[[:space:]]", "", as.character(d[2,3])), ') | ', as.character(d[2,4]),' | ',sprintf('%.2f',d[2,5]),' |')
war3 <- paste0('| 3 | [**',as.character(d[3,2]),'**](/players/',as.character(d[3,1]),') | [',as.character(d[3,3]),'](/teams/',gsub("[[:space:]]", "", as.character(d[3,3])), ') | ', as.character(d[3,4]),' | ',sprintf('%.2f',d[3,5]),' |')
war4 <- paste0('| 4 | [**',as.character(d[4,2]),'**](/players/',as.character(d[4,1]),') | [',as.character(d[4,3]),'](/teams/',gsub("[[:space:]]", "", as.character(d[4,3])), ') | ', as.character(d[4,4]),' | ',sprintf('%.2f',d[4,5]),' |')
war5 <- paste0('| 5 | [**',as.character(d[5,2]),'**](/players/',as.character(d[5,1]),') | [',as.character(d[5,3]),'](/teams/',gsub("[[:space:]]", "", as.character(d[5,3])), ') | ', as.character(d[5,4]),' | ',sprintf('%.2f',d[5,5]),' |')
setwd("~/Google Drive/KBO/kbofancystats/content/home")
writeLines(c(a,b,c,dd,e,f,g,h,ii,j,k,l,m,war1,war2,war3,war4,war5), "blank.md")
# Refresh Pages
render("~/Google Drive/KBO/kbofancystats/content/leaders.Rmd")
render("~/Google Drive/KBO/kbofancystats/content/elo.Rmd")
library(tidyverse)
library(knitr)
library(kableExtra)
batters <- read_csv("~/Google Drive/KBO/batters_simple.csv")
pitchers <- read_csv("~/Google Drive/KBO/pitchers_simple.csv")
batters <- unique(batters)
pitchers <- unique(pitchers)
batters <- batters %>% filter(Year == "Since 2019") %>% subset(PA > 446)
batters <- read_csv("~/Google Drive/KBO/batters_simple.csv")
pitchers <- read_csv("~/Google Drive/KBO/pitchers_simple.csv")
batters <- unique(batters)
pitchers <- unique(pitchers)
View(batters)
batters <- read_csv("~/Google Drive/KBO/batters_simple.csv")
View(batters)
library(tidyverse)
library(knitr)
library(kableExtra)
batters <- read.csv("~/Google Drive/KBO/batters_simple.csv")
pitchers <- read.csv("~/Google Drive/KBO/pitchers_simple.csv")
batters <- unique(batters)
pitchers <- unique(pitchers)
batters <- batters %>% filter(Year == "Since 2019") %>% subset(PA > 446)
pitchers <- pitchers %>% filter(Year == "Since 2019") %>% subset(as.numeric(IP2) > 100)
batters <- read.csv("~/Google Drive/KBO/batters_simple.csv")
pitchers <- read.csv("~/Google Drive/KBO/pitchers_simple.csv")
batters <- unique(batters)
pitchers <- unique(pitchers)
a <- batters %>% filter(Year == "Since 2019") %>% subset(PA > 446)
b <- batters %>% filter(Year == "2020") %>% subset(PA > 446)
b <- batters %>% filter(Year == 2020) %>% subset(PA > 446)
View(batters)
b <- batters %>% filter(Year == 2020)
b <- b %>% subset(PA > (3.1*max(b$G)))
b <- batters %>% filter(Year == 2020)
b <- b %>% subset(PA > (3.1*max(b$G)))
batters <- rbind(a,b)
batters <- read.csv("~/Google Drive/KBO/batters_simple.csv")
pitchers <- read.csv("~/Google Drive/KBO/pitchers_simple.csv")
batters <- unique(batters)
pitchers <- unique(pitchers)
a <- batters %>% filter(Year == "Since 2019") %>% subset(PA > 446)
b <- batters %>% filter(Year == 2020)
b <- b %>% subset(PA > (3.1*max(b$G)))
View(a)
View(b)
b <- b %>% !filter(Code %in% a$Code)
acodes <- a$Code
b <- b %>% !filter(Code %in% acodes)
b <- b %>% filter(!Code %in% acodes)
View(b)
batters <- rbind(a,b)
batters <- read.csv("~/Google Drive/KBO/batters_simple.csv")
pitchers <- read.csv("~/Google Drive/KBO/pitchers_simple.csv")
batters <- unique(batters)
pitchers <- unique(pitchers)
a <- batters %>% filter(Year == "Since 2019")
b <- batters %>% filter(Year == 2020)
b <- b %>% subset(PA > (3.1*max(b$G)))
acodes <- a$Code
b <- b %>% filter(!Code %in% acodes)
batters <- rbind(a,b)
View(b)
View(b)
library(tidyverse)
library(knitr)
library(kableExtra)
batters <- read.csv("~/Google Drive/KBO/batters_simple.csv")
pitchers <- read.csv("~/Google Drive/KBO/pitchers_simple.csv")
batters <- unique(batters)
pitchers <- unique(pitchers)
a <- batters %>% filter(Year == "Since 2019")
b <- batters %>% filter(Year == 2020)
acodes <- a$Code
b <- b %>% filter(!Code %in% acodes)
batters <- rbind(a,b)
batters <- batters %>% filter(PA > 99)
View(batters)
a <- pitchers %>% filter(Year == "Since 2019")
b <- pitchers %>% filter(Year == 2020)
acodes <- a$Code
b <- b %>% filter(!Code %in% acodes)
pitchers <- rbind(a,b)
View(pitchers)
View(b)
pitchers <- pitchers %>% filter(as.numeric(IP2) > 30)
